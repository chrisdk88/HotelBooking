@using Models;
@using System;
@inject HttpClient Http

@using Client.Shared.Utilities;
@using System.Net.Http.Json;

@page "/admin"

<PageTitle>Admin</PageTitle>

@code
{
    private input i = new();

    private List<Room>? rooms;

    protected override async Task OnInitializedAsync()
    {
        rooms = await GetListOfRooms();
    }
}

<h3>Admin panel</h3>

<div class="container text-center mb-4">
    <div class="row">
        <div>
            @if (i == null)
            {
                <p>Loading...</p>
            }
            else
            {
                <EditForm Model="@i">
                    <div class="bg-secondary mb-3">
                        <h2>Tilføj et rum</h2>
                        <div class="">
                            <div class="form-outline mb-4">
                                <label class="form-label" for="formAge">Værelsesnummer</label>
                                    <InputNumber required type="number" id="formAge" class="form-control" placeholder="Værelsesnummer" @bind-Value="i.roomNumber" />
                            </div>
                            <div class="form-outline mb-4">
                                <label class="form-label" for="formAge">Type 1-3</label>
                                    <InputNumber required type="number" id="formAge" class="form-control" placeholder="Type 1-3" @bind-Value="i.typeId" />
                            </div>
                            <button class="btn btn-success" @onclick="addRoom">Tilføj værelse</button>
                        </div>
                    </div>
                    @if (rooms != null)
                    {
                        <div class="div-style bg-danger">
                            @foreach (var room in rooms.Where(item => item.type.name == "Standard"))
                            {
                                <p>@room.roomNum</p>
                                <button class="btn btn-success">Slet</button>
                                <button class="btn btn-success">Optag</button>
                            }
                            @foreach (var room in rooms.Where(item => item.type.name == "Premium"))
                            {
                                <p>@room.roomNum</p>
                                <button class="btn btn-success">Slet</button>
                                <button class="btn btn-success">Optag</button>
                            }
                            @foreach (var room in rooms.Where(item => item.type.name == "Deluxe"))
                            {
                                <p>@room.roomNum</p>
                                <button class="btn btn-success">Slet</button>
                                <button class="btn btn-success">Optag</button>
                            }
                        </div>
                    }
                </EditForm>
            }
        </div>
    </div>
</div>
